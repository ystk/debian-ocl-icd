#!/bin/sh
# vim:ts=4:sw=4
# Calls autotools to build configure script and Makefile.in.
# Generated automatically using bootstrapper 0.2.1
# http://bootstrapper.sourceforge.net/
#
# Copyright (C) 2002 Anthony Ventimiglia
#
# This bootstrap script is free software; you can redistribute
# it and/or modify it under the terms of the GNU General Public
# License as published by the Free Software Foundation; either
# version 2 of the License, or (at your option) any later version.
#
#
# Calls proper programs to create configure script and Makefile.in files.
# if run with the --clean option, bootstrap removes files it generates. To
# clean all autogenerated files (eg: for cvs imports) first run
# make distclean, then bootstrap --clean
# see bootstrapper(1) for more infor

set -e

if test x"$1" = x"--help"; then
	echo "$0: automatic bootstrapping utility for GNU Autotools"
	echo "		cleans up old autogenerated files and runs autoconf,"
	echo "		automake and aclocal on local directory"
	echo
	echo "		--clean		clean up auto-generated files without"
	echo "					creating new scripts"
	echo
	exit 0
fi

export ACLOCAL="aclocal"
export AUTOCONF="autoconf"
export AUTOHEADER="autoheader"
export AUTOMAKE="automake"
CONFIG_AUX_DIR="build-aux"
#LIBTOOLIZE="/usr/bin/libtoolize --force"
#LIBTOOLIZE_FILES="config.sub ltmain.sh config.guess"
#LIBTOOLIZE="libtoolize --copy"
#LIBTOOLIZE="glibtoolize --copy"
CLEAN_BASE_DIRS="autom4te.cache"
CLEAN_BASE_FILES="configure"
CLEAN_BASE_FILES="$CLEAN_BASE_FILES config.h.in config.h.in~"
CLEAN_BASE_FILES="$CLEAN_BASE_FILES aclocal.m4 acinclude/libtool.m4 acinclude/ltoptions.m4"
CLEAN_BASE_FILES="$CLEAN_BASE_FILES acinclude/ltversion.m4 acinclude/lt~obsolete.m4  acinclude/ltsugar.m4"
CLEAN_AUX_FILES="config.guess compile depcomp mkinstalldirs libtool ltmain.sh missing config.sub install-sh mdate-sh texinfo.tex"

RM="rm -v"
SUBDIRS="$(sed -e '/Makefile/s,[[:space:]]*\([^[:space:]]*\)/\?Makefile,./\1,p;d' configure.ac)"

if libtoolize --version >/dev/null 2>&1; then
	export LIBTOOLIZE="libtoolize --force"
else
	# for non GNU OS
	export LIBTOOLIZE="glibtoolize --force"
fi

# These are files created by configure, so we'll always clean them
for i in $ALWAYS_CLEAN; do
	test -f $i && \
	$RM $i
done

if test x"$1" = x"--clean"; then
	#
	#Clean Files left by previous bootstrap run
	#
	if test -n "$CONFIG_AUX_DIR";
		then CONFIG_AUX_DIR="$CONFIG_AUX_DIR/"
	fi
	# Clean directories in base directory
	for cf in $CLEAN_BASE_DIRS; do
		if test -d $cf ; then
			$RM -r $cf
		else
			echo "Skipping non existing directory '$cf'"
		fi
	done
	#Clean Automake generated Makefile.in files
	for i in $SUBDIRS; do
		test -f $i/Makefile.in && \
		$RM $i/Makefile.in
	done
	# Clean files in base directory
	for cf in $CLEAN_BASE_FILES; do
		if test -f $cf ; then
			$RM $cf
		else
			echo "Skipping non existing file '$cf'"
		fi
	done
	# Clean files in aux directory
	for cf in $CLEAN_AUX_FILES; do
		cf="$CONFIG_AUX_DIR$cf"
		if test -f $cf ; then
			$RM $cf
		else
			echo "Skipping non existing file '$cf'"
		fi
	done

else
	set -x
	autoreconf -vi -Wall "$@"
	set +x
fi


